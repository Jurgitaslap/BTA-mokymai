<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <title>Uždavinys19_2</title>
    <style>
        h2,
        h4 tr,
        td {
            text-align: center;
        }

        #saugoti {
            width: 9em;
            margin: 0.1em;
        }

        /* .virs {
            background-color: lightgray;
        } */
    </style>
</head>

<body>
    <h2>Įveskite duomenis</h2>
    <table class="table table-bordered">
        <thead>
            <tr>
                <td scope="col" colspan="6">
                    <button type="button" id="saugoti" class="btn btn-secondary" data-toggle="modal" data-target="#modalData">Naujas</button>
                </td>
            </tr>
            <tr style="background-color: black; color: white;">
                <th scope="col">Data</th>
                <th scope="col">Valstybinis Nr.</th>
                <th scope="col">Atstumas (m)</th>
                <th scope="col">Laikas (s)</th>
                <th scope="col">Greitis (km/h)</th>
                <th scope="col" colspan="2">Veiksmai</th>
            </tr>
        </thead>

        <tbody id="a">
        </tbody>
    </table>

    <!-- bootstrap modal-->
    <div id="modalData" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Užpildykite laukus</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body text-center">

                    <input type="text" id="data" placeholder="">
                    <br>

                    <input type="text" id="numeris" placeholder="">
                    <br>

                    <input type="number" id="atstumas" placeholder="">
                    <br>

                    <input type="number" id="laikas" placeholder="">
                    <br>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal" id="save">Saugoti</button>
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal">Atšaukti</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" role="dialog" id="modalDelete">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body text-center">
                    <p>Ar tikrai norite ištrinti?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal" id="trinti">Taip</button>
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal">Ne</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" role="dialog" id="changeData">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Keisti duomenis</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body text-center">

                    <input type="text" id="naujaData" placeholder="">
                    <br>

                    <input type="text" id="naujasNumeris" placeholder="">
                    <br>

                    <input type="number" id="naujasAtstumas" placeholder="">
                    <br>

                    <input type="number" id="naujasLaikas" placeholder="">
                    <br>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal" id="keisti">Saugoti</button>
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal">Atšaukti</button>
                </div>
            </div>
        </div>
    </div>



    <script>
         function automobilis(date, number, distance, time) {
            this.data = date;
            this.numeris = number;
            this.atstumas = distance;
            this.laikas = time;
            this.greitis = this.atstumas / this.laikas * 3.6;
        }
        var auto = [];
        $('#save').click(function () {
            var data = getVar("data");
            var numeris = getVar("numeris");
            var atstumas = parseInt(getVar("atstumas"));
            var laikas = parseInt(getVar("laikas"));

            var naujasAutomobilis = new automobilis(data, numeris, atstumas, laikas);
            auto.push(naujsAutomobilis);
            printTable();
            salinti("data");
            salinti("numeris");
            salinti("atstumas");
            salinti("laikas");
        });

        function getVar(a) {
            return document.getElementById(a).value;
        }
        function salinti(a) {
            document.getElementById(a).value = "";
        }

       
        function printTable() {
            $('#a').html("");
            auto.forEach((a, i) => {
                // $('#a').append(
                //     '<tr>' +
                //     '<td>' + a.data + '</td>' +
                //     '<td>' + a.numeris + '</td>' +
                //     '<td>' + a.atstumas + '</td>' +
                //     '<td>' + a.laikas + '</td>' +
                //     '<td>' + (a.atstumas / a.laikas * 3.6).toFixed(0) + '</td>' +
                //     "<td><button class='btn btn-outline-dark' onclick = 'trinti(" + i + ")' data-toggle='modal' data-target='#modalDelete'>Naikinti</button></td>' + <button class='btn btn-outline-dark' onclick = 'taisyti(" + i + ")' data-toggle='modal' data-target='#changeData'>Taisyti</button>"
                //     '</tr>');
                $('#a').append('<tr><td>' + d.data + '</td><td>' + d.numeris + '</td><td>' + d.atstumas + '</td><td>' + d.laikas + '</td><td>' + d.greitis + '</td>'
                    + "<td><button class='btn btn-outline-dark' onclick = 'trinti(" + i + ")' data-toggle='modal' data-target='#modalDelete'>Naikinti</button>"
                    + "<button class='btn btn-outline-dark' onclick = 'taisyti(" + i + ")' data-toggle='modal' data-target='#changeData'>Taisyti</button></td>"
                    + '</tr>');
            });

        }

        var deleteRow;
        function trinti(index) {
            deleteRow = index;
        }

        $('#trinti').click(function () {
            auto.splice(deleteRow, 1);
            printTable();
        });
        var editing;
        function taisyti(index) {
            editing = index;
        }
        $('#keisti').click(function () {
            var newData = getVar("naujaData");
            var newNumeris = getVar("naujasNumeris");
            var newAtstumas = getVar("naujasAtstumas");
            var newLaikas = getVar("naujasLaikas");


            if (newData != '') auto[editing].data = newData;
            if (newNumeris != '') auto[editing].numeris = newNumeris;
            if (newAtstumas != '') auto[editing].atstumas = newAtstumas;
            if (newLaikas != '') auto[editing].laikas = newLaikas;

            printTable();
            salinti('naujaData');
            salinti('naujasNumeris');
            salinti('naujasAtstumas');
            salinti('naujasLaikas');

        });


    </script>

</body>

</html>